<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <link href="${path}/css/jquery.jscrollpane.css" rel="stylesheet" />
    <link href="${path}/css/common.css" rel="stylesheet" />
    <link href="${path}/css/imagezoom.css" rel="stylesheet" />
    <link href="${path}/css/product.css" rel="stylesheet" />
    <script src="${path}/js/jquery-1.11.0.js"></script>
    <script src="${path}/js/jquery.easing.1.3.js"></script>
    <script src="${path}/js/jquery.mousewheel.js"></script>
    <script src="${path}/js/jquery.jscrollpane.js"></script>
    <script src="${path}/js/jquery.imgzoom.js"></script>
    <script src="${path}/js/jquery.lazyload.js"></script>
</head>
<body>
    ${include("/common/header.html","UTF-8")}
    ${include("/common/asideMenu.html","UTF-8")}
    <div class="container">
        <div class="row">
            <!--#set(List<PageAlbum> albumList)-->
            <!--#if(albumList)-->
            <!--#for(PageAlbum album : albumList)-->
            <div class="grid grid-${album.imgSize}x1 loading">
                <a href="javascript:void(0);">
                    <img class="lazyload" src="${path}/img/content_${album.imgSize}x1.png" data-src="${path}${album.thumbnailPath}" />
                    <div class="hover-img"><img src="${path}/img/img-hover.png" /></div>
                    <div class="album-photo" style="display:none;">
                        <span data-src="${path}${album.coverPath}"></span>
                        <!--#if(album.photoList)-->
                            <!--#for(Photo photo : album.photoList)-->
                            <span data-src="${path}${photo.path}"></span>
                            <!--#end-->
                        <!--#end-->
                    </div>
                </a>
            </div>
            <!--#end-->
            <!--#end-->
        </div>
    </div>
    ${include("/common/footer.html","UTF-8")}
    <script type="text/javascript">
        $(".container .row .grid > a").click(function () {
            if ($(this).find(".album-photo *[data-src]").length) {
                $(this).imageZoom({ container: ".container" })
                        .data("imgZoom")
                        .show({
                            src: $(this).find(".album-photo *[data-src]").removeClass("active").first().addClass("active").attr("data-src"),
                            current: 1,
                            total: $(this).find(".album-photo *[data-src]").length
                        });
            }
        }).on("prev", function () {
            var src = null, current = null, total = $(this).find(".album-photo *[data-src]").length, photo = null;
            if ($(this).find(".album-photo .active").prev("[data-src]").length > 0) {
                photo = $(this).find(".album-photo .active").removeClass("active").prev("[data-src]").addClass("active");
            }
            else
                photo = $(this).find(".album-photo *[data-src]").removeClass("active").last().addClass("active");
            src = photo.attr("data-src");
            current = photo.prevAll("[data-src]").length + 1;
            $(this).data("imgZoom").show({ src: src });
        }).on("next", function () {
            var src = null, current = null, total = $(this).find(".album-photo *[data-src]").length, photo = null;
            if ($(this).find(".album-photo .active").next("[data-src]").length > 0)
                photo = $(this).find(".album-photo .active").removeClass("active").next("[data-src]").addClass("active");
            else
                photo = $(this).find(".album-photo *[data-src]").removeClass("active").first().addClass("active");
            src = photo.attr("data-src");
            current = photo.prevAll("[data-src]").length + 1;
            $(this).data("imgZoom").show({ src: src });
        });
    </script>
    <script type="text/javascript">
        //分屏加载
        $(".container .row .grid > a > img.lazyload").lazyload({
            data_attribute: "src",
            load: function () {
                $(this).parent().animate({ opacity: 1 }, 1000, EASING_NAME).parent().removeClass("loading");
            }
        }).each(function (i, e) {
            $(this).parent().animate({ opacity: 0 }, 0).parent().addClass("loading");
        });
    </script>
</body>
</html>
